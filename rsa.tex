\documentclass[12pt]{exam}

\newcommand{\docname}{Public key cryptography activity}

% \printanswers
\lhead[Math 404/504]{Page \thepage\ of \numpages}
\rhead{\docname}
\cfoot{}
\headrule
\usepackage{mathpazo,amsmath,amssymb}
\newcommand{\set}[1]{\left\{\,#1\,\right\}}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelitemi}{$\circ$}
\usepackage{tikz}

\usepackage{listings}
\lstset{basicstyle=\small,frame=l,xleftmargin=.5in}

\begin{document}
\begin{questions}
  \question We represent a letter of the alphabet with a number using the rule:
  \[\text{`a'}\to11,\quad\text{`b'}\to12,\quad\ldots,\quad\text{`z'}\to36
  \]
  We represent a string of letters of the alphabet by juxtaposing the representations of the letters, e.g.:
  \[\text{`abc'}\to111213
  \]
  
  A \emph{public key} is a pair $(n,k)$ where $n$ is a product of two distinct primes and $\gcd(k,\phi(n))=1$.
  \begin{parts}
    \part If $m$ is an integer representation of a message and $m<n$, we encrypt $m$ by calculating $m^k\pmod{n}$. If $m\geq n$, one must break $m$ into smaller blocks and encrypt each block separately.
    
    Encrypt the message ``friend'' using $(n,k)=(4189,9)$. We must use three blocks:
    \begin{itemize}
      \item encrypt ``fr''
      \vspace{1cm}
      \item encrypt ``ie''
      \vspace{1cm}
      \item encrypt ``nd''
      \vspace{1cm}
    \end{itemize}
    \part If $c$ is an encrypted message, we decrypt $c$ by solving $x^k\equiv c\pmod{n}$. If $c_1,\ldots,c_l$ is a series of encryped blocks, decrypt them separately and juxtapose the results.
    
    Decrypt the sequence of blocks below using $(n,k)=(4189,9)$:
    \begin{itemize}\itemsep\fill
      \item block 1: 1035
      \item block 2: 942
      \item block 3: 2322
      \item block 4: 942 (already done)
      \item block 5: 4006
      \item block 6: 2400
      \item block 7: 1124
      \item block 8: 3017
      \item block 9: 1863
      \item block 10: 2935
      \item block 11: 4159
    \end{itemize}
  \end{parts}
  \newpage
  \question Send a message to the other two groups. You can use the same message for both, or two different messages. Then decrypt the messages from the other two groups.
  
  The public keys are as follows.
  \begin{parts}
    \part Group 1: 
    \part Group 2: 
    \part Group 3: 
  \end{parts}
\end{questions}
\end{document}


