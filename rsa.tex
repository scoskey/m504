\documentclass[12pt]{exam}

\newcommand{\docname}{Public key cryptography activity}

% \printanswers
\lhead[Math 404/504]{Page \thepage\ of \numpages}
\rhead{\docname}
\cfoot{}
\headrule
\usepackage{mathpazo,amsmath,amssymb}
\newcommand{\set}[1]{\left\{\,#1\,\right\}}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelitemi}{$\circ$}
\usepackage{tikz}

\usepackage{listings}
\lstset{basicstyle=\small,frame=l,xleftmargin=.5in}

\begin{document}
\begin{questions}
  \question We represent a letter of the alphabet with a number using the rule:
  \[\text{`a'}\to11,\quad\text{`b'}\to12,\quad\ldots,\quad\text{`z'}\to36
  \]
  We represent a string of letters of the alphabet by juxtaposing the representations of the letters, e.g.:
  \[\text{`abc'}\to111213
  \]
  To limit the size of the integers, we may break up messages into smaller blocks, e.g.:
  \[\texttt{`hello world'}\to[18152222, 25332528, 2214]
  \]

  Find the integer representation of the following message. Use blocks of four letters. You may use the provided \texttt{str2int} function.
  \[\texttt{`The years of rice and salt'}
  \]
  \vspace\fill
  \question   A \emph{public key} is a pair $(n,k)$ where $n$ is square-free and $\gcd(k,\phi(n))=1$.

  If $a$ is an integer representation of a message and $a<n$, we encrypt $a$ by calculating $a^k\pmod{n}$. If $a\geq n$, break $a$ into several blocks and encrypt each block separately.
    
  Encrypt the message ``friend'' using three blocks and the key $(n,k)=(4189,9)$:
  \begin{itemize}
    \item Write the integer representation of ``fr'':
    \vspace{1cm}
    \item Encrypt ``fr'':
    \vspace{1cm}
    \item Write the integer representation of ``ie'':
    \vspace{1cm}
    \item Encrypt ``ie'':
    \vspace{1cm}
    \item Write the integer representation of ``nd'':
    \vspace{1cm}
    \item Encrypt ``nd'':
    \vspace{1cm}
    \item The final cipher is a list of the three blocks: $[b_1,b_2,b_3]=$
  \end{itemize}
  \newpage
  \question If $b$ is an encrypted message, we decrypt $b$ by solving $x^k\equiv b\pmod{n}$. If $[b_1,\ldots,b_l]$ is a sequence of encryped blocks, decrypt them separately and juxtapose the results.
  
  Again using the key $(n,k)=(4189,9)$, find the \emph{decryption exponent} $u=k^{-1}\pmod{\phi(n)}$. You may use the provided \texttt{invert} function.
  \vspace{1cm}
  
  Now decrypt the sequence of blocks $[b_1,\ldots,b_8]$:
  \begin{itemize}\itemsep\fill
    \item decrypt block $b_1=57$
    \item decrypt block $b_2=1422$
    \item decrypt block $b_3=729$
    \item decrypt block $b_4=2388$
    \item decrypt block $b_5=2375$
    \item decrypt block $b_6=2943$
    \item decrypt block $b_7=1035$
    \item decrypt block $b_8=3590$
  \end{itemize}
  \vspace\fill
  What does the message say? You may use the provided \texttt{decode} function.
  \newpage
  \question Send messages to each of the other two groups. Make the two messages different.
  
  The public keys are as follows.
  \begin{itemize}
    \item Group 1: $(n_1,k)=(5003181913621602664666333189587410364737,65537)$
    \item Group 2: $(n_2,k)=(6772714758430994223689941616505233871071,65537)$
    \item Group 3: $(n_3,k)=(6712640715896604739891503947548506989657,65537)$
  \end{itemize}
  \question Decrypt the messages from the other two groups. I will provide you with your private key: the value of $\phi(n)$.
  \question Can you decrypt the messages that aren't for you?
\end{questions}
\end{document}


