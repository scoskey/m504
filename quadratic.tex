\documentclass[12pt]{exam}

\newcommand{\docname}{Quadratic residues activity}

% \printanswers
\lhead[Math 404/504]{Page \thepage\ of \numpages}
\rhead{\docname}
\cfoot{}
\headrule
\usepackage{mathpazo,amsmath,amssymb}
\newcommand{\set}[1]{\left\{\,#1\,\right\}}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelitemi}{$\circ$}
\usepackage{tikz}

\usepackage{listings}
\lstset{basicstyle=\small,frame=l,xleftmargin=.5in}

\begin{document}
\begin{questions}
  \question A nonzero number $a$ is a \emph{quadratic residue} or simply a \emph{square} modulo $p$ if there exists $b$ such that $a\equiv b^2\pmod{p}$. In this activity we will begin investigating which numbers are squares modulo $p$ and which are not.
  \begin{parts}
    \part Study the list of squares modulo $p$ for several primes $p$. To do this, you can use the \texttt{powertable} function and look at the \textbf{second column}, which is the column of square numbers in that modulus. What observations do you make?
    \vspace\fill
    \part For a given $p$, how many distinct square numbers are there modulo $p$?
  \vspace\fill
    \part Can you explain why for any base $b$, the squares $b^2$ and $(p-b)^2$ are duplicates?
  \vspace\fill
    \part Can you explain why there are no other duplicates in the second column?
  \vspace\fill
    \part What happens when you multiply two squares together modulo $p$? Two non-squares?
  \vspace\fill
  \end{parts}
  \newpage
  \question Study the list of values of $a^{(p-1)/2}$ for several primes $p$. To do this, you can use the \texttt{rabinmillertable} function and look at the \textbf{second-to-last column}. What observations do you make?
  \vspace\fill
  \begin{parts}
    \part We have previously observed the values are always $\pm1$. Can you explain why this is true? [Think about the $F\ell T$, and the number of possible square roots.]
    \vspace\fill
    \part Prove that if $a$ is a square, then $a^{(p-1)/2}$ is equivalent to $1$ modulo $p$. [$F\ell T$ again\ldots]
    \vspace\fill
    \part Can you explain why if $a$ is a nonsquare, then $a^{(p-1)/2}$ must be equivalent to $-1$ modulo $p$? [You can come back to this one\ldots]
    \vspace\fill
  \end{parts}
  \newpage
  \question The Legendre symbol $(\frac ap)$ is defined to be $1$ if $a$ is a square modulo $p$ and to be $-1$ if $a$ is a nonsquare modulo $p$. On the previous page we learned \textbf{Euler's criterion}, that $(\frac ap)\equiv a^{(p-1)/2}\pmod{p}$. Thus we can use the following code to calculate it:
  \begin{lstlisting}
def legendre(a,p):
    ans = pow(a,(p-1)//2,p)
    if ans == 1:
        return 1
    elif ans == p-1:
        return -1
    elif ans == 0:
        return 0
    else:
        return False
  \end{lstlisting}
  In this exercise we investigate the values of $(\frac{-1}{p})$ for primes $p$.
  \begin{parts}
    \part Make a table of primes $p$ and the value of $(\frac{-1}{p})$ for at least $15$ odd primes.
    \vspace\fill
    \part Look at just the primes with $(\frac{-1}{p})=1$. Can you find a condition about $p$ which guarantees that $(\frac{-1}{p})=1$?
    \vspace\fill
  \end{parts}
  \newpage
  \question Here we try to explain the observation on the previous page.
  \begin{parts}
    \part Prove that if $p\equiv1\pmod4$ then $(\frac{-1}{p})=1$.
    \vspace\fill
    \part Can you explain the converse too? That is, prove that if $p\equiv3\pmod4$ then $(\frac{-1}{p})=-1$.
    \vspace\fill
    \part Prove that if $p$ is a prime and $p=n^2+1$ for some $n$, then $p\equiv1\pmod 4$. [You don't need anything fancy for this.]
    \vspace\fill
    \part Prove that if $p$ is an odd prime and $p\mid n^2+1$ for some $n$, then $p\equiv1\pmod 4$. [Hint: Use the equivalence established in (a)(b).]
    \vspace\fill
  \end{parts}
  Thanks to part (f), if $2,p_1,\ldots,p_k$ are primes, then the prime factors of $(2p_1\cdots p_k)^2+1$ are new primes congruent to $1\pmod{4}$!
  \newpage
  \question In this exercise we investigate the values of $(\frac2p)$ for primes $p$.
  \begin{parts}
    \part Consider the example of $p=17$. We can write the product of even numbers $(2)(4)\cdots(16)$ in two different ways:
    \[(2)(4)(6)(8)(10)(12)(14)(16)\equiv
    \begin{cases}
      2^8(1)(2)(3)(4)(5)(6)(7)(8)=2^8\cdot 8!\\
      (2)(4)(6)(8)(-7)(-5)(-3)(-1)=(-1)^4\cdot8!
    \end{cases}
    \]
    Explain why this means $(\frac2p)=(-1)^4=1$.
    \vspace\fill
    \part Explain why the above generalizes to show that for any $p$ we have $(\frac2p)=(-1)^{\lceil(p-1)/4\rceil}$.
    \vspace\fill
    \part Explain why this rule can also be stated as $(\frac2p)=1$ if $p\equiv\pm1\pmod{8}$ and $(\frac2p)=-1$ if $p\equiv\pm3\pmod{8}$.
    \vspace\fill
  \end{parts}
\end{questions}
\end{document}
